import urljoin  from 'url-join';

export const getProtocol = (req) => {
	if (!!req && !!req.headers) {
		if (!!req.headers['x-forwarded-proto']) {
			return req.headers['x-forwarded-proto'];
		} else if (!!req.connection  && !!req.connection.encrypted) {
			return 'https';
		} else if (!!req.headers.referer) {
			return req.headers.referer.split(':')[0];
		}
	}

	return null;
};

export const mapPath = (path, session = null) => {
    if (!!session && !!session.hostname) {
        const protocol = (!!session.protocol) ? session.protocol : 'http';
        return urljoin(`${protocol}://${session.hostname}`, path);
    }

    return path;
};