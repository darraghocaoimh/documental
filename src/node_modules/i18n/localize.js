import { cookieName } from './settings';
import cookie from 'cookie';
import { locale, waitLocale } from 'svelte-i18n';

export default async function localize(page, session) {
    const currentLocale = page.params.locale;
    locale.set(currentLocale);
    session.locale = currentLocale;

    if (typeof document !== 'undefined' && !!document) {
        const localeCookie = cookie.serialize(cookieName, currentLocale);
        document.cookie = localeCookie;
    }

    return await waitLocale();
};