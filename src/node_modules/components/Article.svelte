<script>
    import settings from 'settings'; 
    import { onMount } from 'svelte';
    import { _, locale } from 'svelte-i18n';
    
    import Document from 'components/Document.svelte'
    import TableOfContents from 'components/TableOfContents.svelte'

    export let basePath;
    export let metadata;
    export let monolingual;
    export let toc;
    export let content;

    let title;

    $: if (!!metadata.title && !!metadata.project) {
        title = `${metadata.project} / ${metadata.title}`;
    } else if (!!metadata.title) {
        title = metadata.title;
    }

    $: description = (!!metadata.description) ? metadata.description : $_('global.description');
    $: keywords = (!!metadata.keywords) ? metadata.keywords : $_('global.keywords');
    $: alternateLocale = ($locale === 'en') ? 'ga' : 'en';
	$: openGraphLocale = ($locale === 'ga') ? 'ga_IE' : 'en_GB';
	$: openGraphLocaleAlternate = ($locale === 'ga') ? 'en_GB' : 'ga_IE';
    $: showTOC = !(metadata.toc !== null && metadata.toc === 'false');
    
    function path(targetLocale) {
		const params = basePath.split('/');
		params[1] = targetLocale;
		return params.join('/');
	}
</script>

<svelte:head>
    <title>{title} | {settings.siteName}</title>
    <meta property='og:title' content={title}>
    <meta name='twitter:title' content={`${title} | ${settings.siteName}`}>

    <meta name='description' content={description}>
    <meta property='og:description' content={description}>
    <meta name='twitter:description' content={description}>
    <meta name='keywords' content={keywords}>

    <link rel='alternate' hreflang={alternateLocale} href={`${settings.url}${path(alternateLocale)}`}>
	<meta property='og:locale' content={openGraphLocale}>
	<meta property='og:locale:alternate' content={openGraphLocaleAlternate}>
    <meta property='og:url' content={`${settings.url}${path($locale)}`}>
    <meta name='twitter:url' content={`${settings.url}${path($locale)}`}>

	<meta name='twitter:image' content={settings.metaImage}>
	<meta property='og:image' content={settings.metaImage}>
</svelte:head>

{#if (showTOC)}
    <TableOfContents {toc}/>
{/if}
<Document {metadata} {content} {monolingual}/>