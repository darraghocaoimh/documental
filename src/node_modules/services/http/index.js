import urljoin  from 'url-join';

export const getProtocol = (req) => {
    if (!req || !req.headers) return null;
    
    if (!!req.headers['x-forwarded-proto']) {
        return req.headers['x-forwarded-proto'];
    } else if (!!req.connection  && !!req.connection.encrypted) {
        return 'https';
    } else if (!!req.headers.referer) {
        return req.headers.referer.split(':')[0];
    }
};

export const mapPath = (path, session = null) => {
	if (!session || !session.hostname) return path;
    const protocol = (!!session.protocol) ? session.protocol : 'http';
    return urljoin(`${protocol}://${session.hostname}`, path);
};